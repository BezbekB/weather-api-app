<!DOCTYPE html>
<html lang="pl">
<head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Pogoda</title>
      <link rel="stylesheet" href="style.css">
</head>
<body>
      
      <div class="container">
            
            <div class="weather-card">
                  <p class="error-display">test</p>

                  <p class="country-display"></p>
                  <h1 class="city-display"></h1>

                  <p class="temperature-display"></p>
                  <p class="perceived-temperature-display"></p>

                  <p class="weather-description-display"></p>

                  <p class="weather-icon-display"></p>

                  <p class="wind-speed-display"></p>
                  <p class="wind-direction-display"></p>

                  <p class="humidity-display"></p>

                  <p class="pressure-display"></p>

                  <p class="sunrise-display"></p>
                  <p class="sunset-display"></p>
            </div>
      </div>

      <script>
            const errorDisplay = document.querySelector(".error-display")
            const countryDisplay = document.querySelector(".country-display");
            const cityDisplay = document.querySelector(".city-display");
            const temperatureDisplay = document.querySelector(".temperature-display");
            const perceivedTemperatureDisplay = document.querySelector(".perceived-temperature-display");
            const weatherDescriptionDisplay = document.querySelector(".weather-description-display");
            const weatherIconDisplay = document.querySelector(".weather-icon-display");
            const windSpeedDisplay = document.querySelector(".wind-speed-display");
            const windDirectionDisplay = document.querySelector(".wind-direction-display");
            const humidityDisplay = document.querySelector(".humidity-display");
            const pressureDisplay = document.querySelector(".pressure-display");
            const sunriseDisplay = document.querySelector(".sunrise-display");
            const sunsetDisplay = document.querySelector(".sunset-display");

            const API_KEY = "da026bc4ff7d43ff0ec6daf8cce10987";



            function showError(error)
            {
                  errorDisplay.innerHTML = error;
            }

            async function getWeatherData(lat, lon)
            {
                  try
                  {
                        const response = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&lang=pl&appid=${API_KEY}`);

                        if(!response.ok)
                        {
                              throw new Error("Nie moÅ¼na wydobyÄ‡ danych!");
                        }

                        const data = await response.json();

                        console.log(data);

                        countryDisplay.innerHTML = `Kraj: ${data.sys.country}`;
                        cityDisplay.innerHTML = `Miasto: ${data.name}`;
                        temperatureDisplay.innerHTML = `Temperatura: ${Math.round(data.main.temp)}Â°C`;
                        perceivedTemperatureDisplay.innerHTML = `Temperatura odczuwalna: ${Math.round(data.main.feels_like)}Â°C`;
                        weatherDescriptionDisplay.innerHTML = `Pogoda: ${data.weather[0].description}`;
                        switch(data.weather[0].main)
                        {
                              case "Clouds":
                                    weatherIconDisplay.innerHTML = "â˜ï¸";
                                    break;
                              case "Rain":
                                    weatherIconDisplay.innerHTML = "ðŸŒ§ï¸";
                                    break;
                              case "Clear":
                                    weatherIconDisplay.innerHTML = "â˜€ï¸";
                                    break;
                              case "Thunderstorm":
                                    weatherIconDisplay.innerHTML = "â›ˆï¸";
                                    break;
                              case "Snow":
                                    weatherIconDisplay.innerHTML = "â„ï¸";
                                    break;
                        }
                        windSpeedDisplay.innerHTML = `PrÄ™dkoÅ›Ä‡ wiatru: ${data.wind.speed} m/s`;
                        windDirectionDisplay.innerHTML = `Kierunek wiatru: ${data.wind.deg}Â°`;
                        humidityDisplay.innerHTML = `WilgotnoÅ›Ä‡: ${data.main.humidity}%`;
                        pressureDisplay.innerHTML = `CiÅ›nienie: ${data.main.pressure}hPa`;
                        sunriseDisplay.innerHTML = `WschÃ³d sÅ‚onÄ‡a: ${new Date(data.sys.sunrise * 1000).toLocaleTimeString("pl-PL", {hour: "2-digit", minute: "2-digit"})}`;
                        sunsetDisplay.innerHTML = `ZachÃ³d sÅ‚oÅ„ca: ${new Date(data.sys.sunset * 1000).toLocaleTimeString("pl-PL", {hour: "2-digit", minute: "2-digit"})}`;
                        
                  }
                  catch(error)
                  {
                        showError(error);
                  }
            }

            function getLocation()
            {
                  if(navigator.geolocation)
                  {
                        navigator.geolocation.getCurrentPosition(position => 
                              {
                                    const lat = position.coords.latitude;
                                    const lon = position.coords.longitude;
                                    getWeatherData(lat, lon);
                              }, error => 
                                    {
                                          showError("Nie moÅ¼na uzyskaÄ‡ lokalizacji!");
                                    }
                        )
                  }
                  else
                  {
                        showError("Twoja przeglÄ…darka nie wspiera geolokalizacji!");
                  }
            }

            document.addEventListener("DOMContentLoaded", getLocation);

            
      </script>
</body>
</html>